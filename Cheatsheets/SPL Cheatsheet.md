# Splunk SPL Cheatsheet

| **Category**               | **SPL Command**                                                                                                                                              | **Description**                                                             |
|----------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|
| **Basic Queries**           | `index=your_index`                                                                                                                                          | Search within a specific index.                                             |
|                            | `index=your_index sourcetype=your_sourcetype`                                                                                                                | Filter by sourcetype.                                                      |
|                            | `*`                                                                                                                                                         | Search all data in the index.                                              |
| **Filtering and Searching** | `index=your_index sourcetype=your_sourcetype field="value"`                                                                                               | Filter rows with specific field values.                                     |
|                            | `index=your_index \| search field="value"`                                                                                                                   | Filter using `search` command after a query.                                |
|                            | `index=your_index \| where field > 100`                                                                                                                     | Filter with a condition (numeric).                                          |
|                            | `index=your_index \| regex field="^regex_pattern"`                                                                                                           | Filter using regular expressions.                                           |
| **Time Filtering**          | `index=your_index earliest=-24h@h latest=now`                                                                                                              | Time range filtering (last 24 hours).                                       |
|                            | `index=your_index earliest="2024-01-01T00:00:00" latest="2024-12-31T23:59:59"`                                                                            | Exact time range filtering.                                                 |
|                            | `index=your_index \| timechart span=1h count`                                                                                                                 | Timechart by hour.                                                          |
| **Aggregation and Grouping**| `index=your_index \| stats count by field`                                                                                                                 | Aggregate (count) by field.                                                |
|                            | `index=your_index \| stats sum(field) by field2`                                                                                                           | Sum of a field, grouped by another field.                                   |
|                            | `index=your_index \| stats avg(field) by field2`                                                                                                           | Average of a field, grouped by another field.                               |
| **Sorting**                 | `index=your_index \| sort - field`                                                                                                                         | Sort in descending order by field.                                          |
|                            | `index=your_index \| sort field`                                                                                                                           | Sort in ascending order by field.                                           |
| **Joins**                   | `index=your_index \| lookup lookup_file field AS lookup_field OUTPUT new_field`                                                                                 | Lookup table join.                                                          |
| **String Functions**        | `index=your_index \| eval new_field=lower(field)`                                                                                                          | Convert field value to lowercase.                                           |
|                            | `index=your_index \| eval new_field=upper(field)`                                                                                                          | Convert field value to uppercase.                                           |
|                            | `index=your_index \| eval new_field=replace(field, "old", "new")`                                                                                             | Replace substring in a field.                                              |
|                            | `index=your_index \| eval new_field=substr(field, 0, 5)`                                                                                                    | Extract substring from a field.                                            |
| **Date and Time Functions** | `index=your_index \| eval epoch_time=strptime(field, "%Y-%m-%d %H:%M:%S")`                                                                                    | Convert string to epoch time.                                               |
|                            | `index=your_index \| eval formatted_time=strftime(epoch_time, "%Y-%m-%d %H:%M:%S")`                                                                          | Format timestamp as a string.                                               |
|                            | `index=your_index \| eval day_of_week=strftime(_time, "%A")`                                                                                                 | Get day of the week from `_time`.                                           |
| **Subqueries**              | `index=your_index \| [search index=other_index \| stats count by field]`                                                                                     | Subquery for a search command.                                              |
| **Field Extraction**        | `index=your_index \| rex field=_raw "pattern"`                                                                                                              | Extract field using regex.                                                 |
|                            | `index=your_index \| extract pairdelim="," kvdelim="="`                                                                                                      | Extract key-value pairs from raw logs.                                      |
| **Event Statistics**        | `index=your_index \| stats avg(field) as avg_field by field2`                                                                                              | Calculate statistics (average, sum, etc.) by field.                         |
|                            | `index=your_index \| stats count as total_count by _time`                                                                                                  | Count events by time.                                                      |
| **Conditional Logic**       | `index=your_index \| eval new_field=if(field > 100, "High", "Low")`                                                                                         | Conditional logic (if-else).                                                |
|                            | `index=your_index \| eval new_field=case(field > 100, "High", field > 50, "Medium", field <= 50, "Low")`                                                        | Multiple conditions (case).                                                |
| **Data Transformation**     | `index=your_index \| stats sum(field) as total by field2`                                                                                                  | Group and aggregate data by a field.                                        |
|                            | `index=your_index \| transpose row 1 column field`                                                                                                          | Reshape data (transpose rows and columns).                                  |
| **Search Command Modifiers**| `index=your_index \| dedup field`                                                                                                                         | Remove duplicate values for a field.                                        |
|                            | `index=your_index \| top field`                                                                                                                           | Get the most frequent values of a field.                                    |
|                            | `index=your_index \| table field1, field2`                                                                                                                 | Display fields in a table format.                                           |
| **Comments**                | `# This is a single-line comment`                                                                                                                         | Single-line comment.                                                       |
|                            | `/* This is a multi-line comment \n that spans multiple lines */`                                                                                         | Multi-line comment.                                                        |
| **Saving Results**          | `index=your_index \| outputcsv "results.csv"`                                                                                                              | Save query results into a CSV file.                                         |
