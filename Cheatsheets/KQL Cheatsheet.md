# KQL Cheatsheet

| **Category**               | **KQL Command**                                                                                                                                              | **Description**                                                             |
|----------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|
| **Basic Queries**           | `TableName`                                                                                                                                               | Select all rows from a table.                                               |
|                            | `TableName \| project Column1, Column2`                                                                                                                      | Select specific columns.                                                   |
|                            | `TableName \| take 10`                                                                                                                                         | Limit the number of rows.                                                  |
|                            | `TableName \| top 5 by Column1`                                                                                                                               | Top N rows by a column.                                                    |
| **Filtering and Searching** | `TableName \| where Column1 == "Value"`                                                                                                                        | Filter rows based on condition.                                             |
|                            | `TableName \| where Column1 == "Value" and Column2 > 100`                                                                                                      | Multiple conditions.                                                       |
|                            | `TableName \| where Column1 matches regex @"\d{4}-\d{2}-\d{2}"`                                                                                                 | Regex match for pattern.                                                   |
|                            | `TableName \| where Timestamp > datetime(2024-01-01) and Timestamp < datetime(2024-12-31)`                                                                    | Date range filtering.                                                      |
| **Aggregation and Grouping**| `TableName \| count`                                                                                                                                           | Count rows in the table.                                                   |
|                            | `TableName \| summarize Count = count() by Column1`                                                                                                           | Group by and aggregate (count).                                            |
|                            | `TableName \| summarize Count = count() by Column1, Column2`                                                                                                   | Group by multiple columns.                                                 |
|                            | `TableName \| summarize Total = sum(Column1), AvgValue = avg(Column2) by Column3`                                                                              | Aggregation functions (sum, avg).                                          |
| **Sorting**                 | `TableName \| order by Column1 asc`                                                                                                                             | Sort by a column in ascending order.                                       |
|                            | `TableName \| order by Column1 desc, Column2 asc`                                                                                                              | Sort by multiple columns (mixed order).                                    |
| **Joins**                   | `Table1 \| join kind=inner (Table2) on CommonColumn`                                                                                                          | Inner join two tables.                                                     |
|                            | `Table1 \| join kind=leftouter (Table2) on CommonColumn`                                                                                                     | Left outer join two tables.                                                |
|                            | `Table1 \| join kind=fullouter (Table2) on CommonColumn`                                                                                                    | Full outer join two tables.                                                |
| **String Functions**        | `TableName \| project FullName = strcat(FirstName, " ", LastName)`                                                                                             | Concatenate two columns.                                                   |
|                            | `TableName \| project ShortValue = substring(Column1, 0, 5)`                                                                                                  | Extract substring from a column.                                           |
|                            | `TableName \| project LowerColumn = tolower(Column1)`                                                                                                        | Convert column to lowercase.                                               |
| **Date and Time Functions** | `| extend CurrentTime = now()`                                                                                                                              | Get current time.                                                           |
|                            | `TableName \| extend TimeDiff = now() - Timestamp`                                                                                                            | Date subtraction (difference).                                             |
|                            | `TableName \| extend Year = year(Timestamp)`                                                                                                                  | Extract year from timestamp.                                               |
|                            | `TableName \| extend FormattedDate = format_datetime(Timestamp, "yyyy-MM-dd")`                                                                                  | Format date.                                                                |
| **Summarization**           | `TableName \| summarize RunningTotal = sum(Column1) by bin(Timestamp, 1h) \| extend RunningTotal = row_cumsum(RunningTotal)`                                | Running total across time (using `row_cumsum`).                             |
|                            | `TableName \| summarize PercentileValue = percentile(Column1, 90)`                                                                                             | Get a percentile (e.g., 90th percentile).                                  |
| **Conditional Logic**       | `TableName \| extend Status = case(Column1 == "A", "Active", Column1 == "B", "Inactive", "Unknown")`                                                            | Conditional logic (if-else).                                                |
|                            | `TableName \| project FinalValue = coalesce(Column1, Column2, "Default Value")`                                                                                  | Coalesce: returns the first non-null value from multiple columns.           |
| **Data Transformation**     | `TableName \| summarize Count = count() by Category, bin(Timestamp, 1d) \| project-away Category \| pivot Count by Category`                              | Pivot data into columns (reshape data).                                    |
|                            | `TableName \| mv-expand Column1`                                                                                                                                | Explode array columns into rows.                                           |
| **Subqueries**              | `TableName \| where Column1 in (Table2 \| project Column1)`                                                                                                    | Subquery in `where` clause.                                                 |
|                            | `Table1 \| join (Table2 \| where Column1 == "Value") on CommonColumn`                                                                                           | Subquery in a join.                                                        |
| **Table Management**        | `.show tables`                                                                                                                                             | List all tables.                                                           |
|                            | `.show table TableName schema`                                                                                                                             | Get the schema of a table.                                                 |
|                            | `TableName \| take 5`                                                                                                                                         | Show recent records.                                                       |
| **Comments**                | `// This is a single-line comment`                                                                                                                         | Single-line comment.                                                       |
|                            | `/* This is a multi-line comment \n It can span multiple lines */`                                                                                         | Multi-line comment.                                                        |
| **Saving Results**          | `TableName \| where Column1 == "Value" \| into TableName_Results`                                                                                            | Save query results into a new table.                                        |
